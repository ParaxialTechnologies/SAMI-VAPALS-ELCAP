<!DOCTYPE html>
<html lang="en">
 <head>
  <!-- Required meta tags -->
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <title>
   Intake Form
  </title>
  <link href="lib/bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="lib/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
  <link href="lib/formvalidation/dist/css/formValidation.min.css" rel="stylesheet"/>
  <link href="lib/bootstrap-datetimepicker-4.17.47/css/bootstrap-datetimepicker.css" rel="stylesheet"/>
  <link href="vapals.css" rel="stylesheet"/>
 </head>
 <body>
  <script src="lib/jquery-3.2.1.slim.min.js">
  </script>
  <script src="lib/popper.min.js">
  </script>
  <script src="lib/bootstrap-3.3.7-dist/js/bootstrap.min.js">
  </script>
  <script src="lib/moment.js">
  </script>
  <script src="lib/formvalidation/dist/js/formValidation.min.js">
  </script>
  <script src="lib/formvalidation/dist/js/framework/bootstrap.min.js">
  </script>
  <script src="lib/bootstrap-datetimepicker-4.17.47/js/bootstrap-datetimepicker.min.js">
  </script>
  <script src="https://www.gstatic.com/charts/loader.js" type="text/javascript">
  </script>
  <script src="jquery-conditonally-enable.js">
  </script>
  <script src="vapals.js">
  </script>
  <!--Debug information for viewport-->
  <!--System Navigation-->
  <nav class="navbar navbar-default" role="navigation">
   <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
     <button class="navbar-toggle collapsed" data-target="#navbar-main" data-toggle="collapse" type="button">
      <span class="sr-only">
       Toggle navigation
      </span>
      <span class="icon-bar">
      </span>
      <span class="icon-bar">
      </span>
      <span class="icon-bar">
      </span>
     </button>
     <a href="home.html">
      <img alt="VA-PALS Logo" height="50" src="img/new-logo.png" title="VA-PALS"/>
     </a>
    </div>
    <div class="navbar-collapse collapse" id="navbar-main">
     <ul class="nav navbar-nav">
      <li>
       <a href="home.html">
        Home
       </a>
      </li>
      <li class="dropdown" id="studyIdMenu" style="display:none;">
       <a class="navbar-link" href="casereview.html">
        Case Review
       </a>
      </li>
     </ul>
    </div>
   </div>
  </nav>
  <div class="container-fluid" style="max-width:1550px">
   <h1>
    Sample, Sammy G
    <small class="text-muted" title="Study ID">
     ST0001
    </small>
   </h1>
   <h2>
    Intake Form
    <small class="text-muted" title="Medical Record Number">
     1234567890
    </small>
   </h2>
   <hr/>
   <form action="intake.html" class="validated" data-fv-button-selector="#submit-button" data-fv-icon-invalid="glyphicon glyphicon-remove" data-fv-icon-valid="glyphicon glyphicon-ok" data-fv-icon-validating="glyphicon glyphicon-refresh" method="post">
    <div class="row">
     <div class="col-sm-6 col-md-3 form-group">
      <label for="sinamel">
       Patient Last Name
      </label>
      <input class="form-control" id="sinamel" name="sinamel" required="required" type="text"/>
     </div>
     <div class="col-sm-6 col-md-3 form-group">
      <label for="sinamef">
       First Name
      </label>
      <input class="form-control" id="sinamef" name="sinamef" required="required" type="text"/>
     </div>
     <div class="col-sm-4 col-md-3 form-group">
      <label for="sidfc">
       Date of First Contact
      </label>
      <!--TODO: inject max date as "today"-->
      <div class="input-group datepicker">
       <!--TODO: inject max date as "today"-->
       <input aria-describedby="sidfc-addon" class="form-control" data-fv-callback="true" data-fv-callback-callback="validateInternationalDate" data-fv-callback-message="Enter a valid date" data-max-date="01/Mar/2018" id="sidfc" name="sidfc"/>
       <div class="input-group-addon">
        <div class="input-group-text" id="sidfc-addon">
         <i aria-hidden="true" class="fa fa-calendar">
         </i>
        </div>
       </div>
      </div>
      <small class="form-text text-muted">
       DD/MMM/YYYY
      </small>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-sm-3 col-md-2">
      <label for="sisid">
       Study ID
      </label>
      <input name="hvsisid" type="hidden" value="VEP0001"/>
      <input class="form-control" id="sisid" name="sisid" onfocus="savesid()" required="required" type="text" value="VEP0001"/>
     </div>
     <div class="form-group col-sm-3 col-md-2">
      <label for="sifsid">
       Other Study ID
      </label>
      <input class="form-control" id="sifsid" name="sifsid" onchange="confirmfsid()" onfocus="savefsid()" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-sm-3 col-md-3 col-lg-2">
      <label for="sidoe">
       Date of Baseline CT
      </label>
      <!--TODO: inject max date as "today"-->
      <div class="input-group datepicker">
       <!--TODO: inject max date as "today"-->
       <input aria-describedby="sidoe-addon" class="form-control" data-fv-callback="true" data-fv-callback-callback="validateInternationalDate" data-fv-callback-message="Enter a valid date" data-max-date="01/Mar/2018" id="sidoe" name="sidoe"/>
       <div class="input-group-addon">
        <div class="input-group-text" id="sidoe-addon">
         <i aria-hidden="true" class="fa fa-calendar">
         </i>
        </div>
       </div>
      </div>
      <small class="form-text text-muted">
       DD/MMM/YYYY
      </small>
     </div>
     <div class="form-group col-sm-3 col-md-3 col-lg-2">
      <label for="simrn">
       MRN
      </label>
      <input class="form-control" id="simrn" name="simrn" required="required" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-sm-12">
      <div class="checkbox">
       <label>
        <input id="sisa" name="sisa" type="checkbox" value="y"/>
        Requires Special Attention
       </label>
      </div>
     </div>
    </div>
    <hr/>
    <div class="row">
     <div class="form-group col-md-12">
      <label for="siadcomna">
       Note
      </label>
      <textarea class="form-control" cols="65" id="siadcomna" name="siadcomna" rows="2"></textarea>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-12">
      <label for="siadcom">
       Notes &amp; Correspondence
      </label>
      <textarea class="form-control" cols="65" disabled="disabled" id="siadcom" name="siadcom" rows="4" style="font-family: monospace;">                    </textarea>
      <button class="btn-link" data-target="#correspondenceModal" data-toggle="modal" type="button">
       Add Correspondence
      </button>
     </div>
    </div>
    <hr/>
    <h3>
     Patient Contact Information
     <i aria-hidden="true" class="small fa fa-question-circle-o" data-content="Use the Update button when the patient's contact information changes. It will save a
                                 copy of the information into the Additional Patient Information and clear the
                                 appropriate fields so that you may enter the new contact information.
                                 &lt;button class='btn btn-sm btn-default' onclick='updatePatientContactInfo();'&gt;Update&lt;/button&gt;" data-html="true" data-toggle="popover" data-trigger="click" title="Update Patient Contact Information">
     </i>
    </h3>
    <div class="row">
     <div class="form-group col-sm-6 ">
      <label for="sipsa">
       Street Address
      </label>
      <input class="form-control" id="sipsa" name="sipsa" type="text"/>
     </div>
     <div class="form-group col-sm-2">
      <label for="sipan">
       Apt #
      </label>
      <input class="form-control" id="sipan" name="sipan" type="text"/>
     </div>
     <div class="form-group col-sm-4">
      <label for="sipcn">
       County
      </label>
      <input class="form-control" id="sipcn" name="sipcn" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-6">
      <label for="sipc">
       City
      </label>
      <input class="form-control" id="sipc" name="sipc" type="text"/>
     </div>
     <div class="form-group col-md-1">
      <label for="sips">
       State
      </label>
      <input class="form-control" id="sips" name="sips" type="text"/>
     </div>
     <div class="form-group col-md-2">
      <label for="sipz">
       Zip
      </label>
      <input class="form-control" id="sipz" name="sipz" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="sipcr">
       Country
      </label>
      <input class="form-control" id="sipcr" name="sipcr" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-sm-6 col-md-4 col-lg-3">
      <label for="sipw">
       Phone (Work)
      </label>
      <input class="form-control" data-fv-phone="true" data-fv-phone-country="US" id="sipw" name="sipw" onchange="synChk('sipw','phone')" type="text"/>
     </div>
     <div class="form-group col-sm-6 col-md-4 col-lg-3">
      <label for="siph">
       Phone (Home)
      </label>
      <input class="form-control" data-fv-phone="true" data-fv-phone-country="US" id="siph" name="siph" onchange="synChk('siph','phone')" type="text"/>
     </div>
     <div class="form-group col-md-4 col-lg-6">
      <label for="sipem">
       Email Address
      </label>
      <input class="form-control" data-fv-emailaddress="true" id="sipem" name="sipem" type="text"/>
     </div>
    </div>
    <hr/>
    <h3>
     Physician Contact Information
     <i aria-hidden="true" class="small fa fa-question-circle-o" data-content="Use the Update button when the physician's contact
                                               information changes.  It will save a copy of the information into the
                                               Additional Patient Information and clear the appropriate fields so that
                                               you may enter the new contact information.
                                               &lt;button class='btn btn-sm btn-default' onclick='updatePhysicianContactInfo();'&gt;Update&lt;/button&gt;" data-html="true" data-toggle="popover" data-trigger="click" title="Update Physician Contact Information">
     </i>
    </h3>
    <div class="row">
     <div class="form-group col-md-12">
      <label for="simdn">
       Physician's Name
      </label>
      <input class="form-control" id="simdn" name="simdn" type="text"/>
     </div>
    </div>
    <h4>
     Address
     <small>
      only required for non-VA physicians
     </small>
    </h4>
    <div class="row">
     <div class="form-group col-md-8">
      <label for="simdsa">
       Street Address
      </label>
      <input class="form-control" id="simdsa" name="simdsa" type="text"/>
     </div>
     <div class="form-group col-md-4">
      <label for="simdcn">
       County
      </label>
      <input class="form-control" id="simdcn" name="simdcn" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-6">
      <label for="simdc">
       City
      </label>
      <input class="form-control" id="simdc" name="simdc" type="text"/>
     </div>
     <div class="form-group col-md-1">
      <label for="simds">
       State
      </label>
      <input class="form-control" id="simds" name="simds" type="text"/>
     </div>
     <div class="form-group col-md-2">
      <label for="simdz">
       Zip
      </label>
      <input class="form-control" id="simdz" name="simdz" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="simdcr">
       Country
      </label>
      <input class="form-control" id="simdcr" name="simdcr" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-sm-6 col-md-4 col-lg-3">
      <label for="simdp">
       Physician's Phone
      </label>
      <input class="form-control" data-fv-phone="true" data-fv-phone-country="US" id="simdp" name="simdp" onchange="synChk('simdp','phone')" type="text"/>
     </div>
     <div class="form-group col-sm-6 col-md-4 col-lg-3">
      <label for="simdf">
       Physician's Fax
      </label>
      <input class="form-control" data-fv-phone="true" data-fv-phone-country="US" id="simdf" name="simdf" onchange="synChk('simdf','phone')" type="text"/>
     </div>
    </div>
    <hr/>
    <div class="row">
     <div class="form-group col-sm-3 col-lg-2">
      <label for="sidob">
       Date of Birth
      </label>
      <!--TODO: inject max date as "today"-->
      <div class="input-group datepicker">
       <!--TODO: inject max date as "today"-->
       <input aria-describedby="sidob-addon" class="form-control" data-fv-callback="true" data-fv-callback-callback="validateInternationalDate" data-fv-callback-message="Enter a valid date" data-fv-notempty-message="Date of birth is required" data-max-date="01/Mar/2018" id="sidob" name="sidob" required="required"/>
       <div class="input-group-addon">
        <div class="input-group-text" id="sidob-addon">
         <i aria-hidden="true" class="fa fa-calendar">
         </i>
        </div>
       </div>
      </div>
      <small class="form-text text-muted">
       DD/MMM/YYYY
      </small>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-12">
      <label for="sissn">
       SSN
      </label>
      <i aria-hidden="true" class="small fa fa-question-circle-o" data-content="Please enter the social security number of the subject." data-toggle="popover">
      </i>
      <input class="form-control" data-fv-regexp-message="SSN should be in XXX-XX-XXXX format" id="sissn" name="sissn" onchange="synChk('sissn','ssn')" pattern="^(?!000|666)(?:[0-6][0-9]{2}|7(?:[0-6][0-9]|7[0-2]))-(?!00)[0-9]{2}-(?!0000)[0-9]{4}$" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-4">
      <label for="sifnm">
       Mother's First Name
      </label>
      <input class="form-control" id="sifnm" name="sifnm" type="text"/>
     </div>
     <div class="form-group col-md-4">
      <label for="sifnf">
       Father's First Name
      </label>
      <input class="form-control" id="sifnf" name="sifnf" type="text"/>
     </div>
    </div>
    <div class="alert alert-warning">
     It is important to identify two contacts.
                At least one needs to be at another address.
    </div>
    <div class="row">
     <div class="form-group col-md-3">
      <label for="sikn">
       Emergency Contact (1)
      </label>
      <label for="sikn">
       Name
      </label>
      <input class="form-control" id="sikn" name="sikn" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="sikr">
       Relation
      </label>
      <input class="form-control" id="sikr" name="sikr" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="sika">
       Address
      </label>
      <input class="form-control" id="sika" name="sika" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="sikp">
       Phone
      </label>
      <input class="form-control" data-fv-phone="true" data-fv-phone-country="US" id="sikp" name="sikp" onchange="synChk('sikp','phone')" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-3">
      <label for="siknb">
       Emergency Contact (2)
      </label>
      <label for="siknb">
       Name
      </label>
      <input class="form-control" id="siknb" name="siknb" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="sikrb">
       Relation
      </label>
      <input class="form-control" id="sikrb" name="sikrb" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="sikab">
       Address
      </label>
      <input class="form-control" id="sikab" name="sikab" type="text"/>
     </div>
     <div class="form-group col-md-3">
      <label for="sikpb">
       Phone
      </label>
      <input class="form-control" data-fv-phone="true" data-fv-phone-country="US" id="sikpb" name="sikpb" onchange="synChk('sikpb','phone')" type="text"/>
     </div>
    </div>
    <hr/>
    <div class="row">
     <div class="form-group col-md-12">
      <label for="sicnc-0">
       Phone Calls
      </label>
      <label class="radio-inline">
       <input id="sicnc-0" name="sicnc" onclick="insertPatientCorrespondence('sicnc')" type="radio" value="0"/>
       0
      </label>
      <label class="radio-inline">
       <input id="sicnc-1" name="sicnc" onclick="insertPatientCorrespondence('sicnc')" type="radio" value="1"/>
       1
      </label>
      <label class="radio-inline">
       <input id="sicnc-2" name="sicnc" onclick="insertPatientCorrespondence('sicnc')" type="radio" value="2"/>
       2
      </label>
      <label class="radio-inline">
       <input id="sicnc-3" name="sicnc" onclick="insertPatientCorrespondence('sicnc')" type="radio" value="3"/>
       3
      </label>
      <label class="radio-inline">
       <input id="sicnc-x" name="sicnc" onclick="insertPatientCorrespondence('sicnc')" type="radio" value="x"/>
       X
      </label>
     </div>
     <div class="form-group col-md-12">
      <label for="sicnc-0">
       Letters
      </label>
      <label class="radio-inline">
       <input id="sicnl-0" name="sicnl" onclick="insertPatientCorrespondence('sicnl')" type="radio" value="0"/>
       0
      </label>
      <label class="radio-inline">
       <input id="sicnl-1" name="sicnl" onclick="insertPatientCorrespondence('sicnl')" type="radio" value="1"/>
       1
      </label>
      <label class="radio-inline">
       <input id="sicnl-2" name="sicnl" onclick="insertPatientCorrespondence('sicnl')" type="radio" value="2"/>
       2
      </label>
      <label class="radio-inline">
       <input id="sicnl-3" name="sicnl" onclick="insertPatientCorrespondence('sicnl')" type="radio" value="3"/>
       3
      </label>
      <label class="radio-inline">
       <input id="sicnl-x" name="sicnl" onclick="insertPatientCorrespondence('sicnl')" type="radio" value="x"/>
       X
      </label>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-4">
      <label for="sies">
       Patient Status
      </label>
      <select class="form-control" id="sies" name="sies">
       <option value="ac">
        active
       </option>
       <option value="tr">
        transferred to another institution (specify)
       </option>
       <option value="mr">
        unable due to medical reason (specify)
       </option>
       <option value="pr">
        unwilling due to personal reason (specify)
       </option>
       <option value="rf">
        refused to continue
       </option>
       <option value="pa">
        physician advised against
       </option>
       <option value="ra">
        concern about radiation
       </option>
       <option value="mv">
        moved and unable to return
       </option>
       <option value="in">
        no insurance, can't have Dx CT
       </option>
       <option value="bc">
        burden of cost
       </option>
       <option value="os">
        other (specify)
       </option>
       <option value="es">
        excluded (specify)
       </option>
       <option value="sc">
        study complete
       </option>
       <option value="nr">
        no response to 3 calls + 3 letters
       </option>
       <option value="nc">
        unable to contact
       </option>
       <option value="fe">
        being followed elsewhere (get results)
       </option>
       <option value="ex">
        expired (record date / cause)
       </option>
      </select>
     </div>
     <div class="form-group col-md-8">
      <label for="sieso">
       Specify
      </label>
      <input class="form-control" id="sieso" name="sieso" required="required" type="text"/>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-md-4">
      <label for="sixdate">
       Date of Exit
      </label>
      <i aria-hidden="true" class="fa fa-question-circle-o" data-content="The Date of Exit should be recorded for all subjects who are no longer active in
                       the study.  It signifies the date on which they change to a non-active status." data-toggle="popover">
      </i>
      <!--TODO: inject max date as "today"-->
      <div class="input-group datepicker">
       <!--TODO: inject max date as "today"-->
       <input aria-describedby="sixdate-addon" class="form-control" data-fv-callback="true" data-fv-callback-callback="validateInternationalDate" data-fv-callback-message="Enter a valid date" data-max-date="01/Mar/2018" id="sixdate" name="sixdate"/>
       <div class="input-group-addon">
        <div class="input-group-text" id="sixdate-addon">
         <i aria-hidden="true" class="fa fa-calendar">
         </i>
        </div>
       </div>
      </div>
      <small class="form-text text-muted">
       DD/MMM/YYYY
      </small>
     </div>
    </div>
    <div class="row">
     <div class="form-group col-sm-3 col-md-3 col-lg-2">
      <label for="">
       DOD
      </label>
      <i aria-hidden="true" class="fa fa-question-circle-o" data-content="The Date of Death (DOD) should be recorded for all subjects who have expired." data-toggle="popover">
      </i>
      <!--TODO: inject max date as "today"-->
      <div class="input-group datepicker">
       <!--TODO: inject max date as "today"-->
       <input aria-describedby="sidod-addon" class="form-control" data-fv-callback="true" data-fv-callback-callback="validateInternationalDate" data-fv-callback-message="Enter a valid date" data-fv-notempty-message="Date of death is required" data-max-date="01/Mar/2018" id="sidod" name="sidod" required="required"/>
       <div class="input-group-addon">
        <div class="input-group-text" id="sidod-addon">
         <i aria-hidden="true" class="fa fa-calendar">
         </i>
        </div>
       </div>
      </div>
      <small class="form-text text-muted">
       DD/MMM/YYYY
      </small>
     </div>
     <div class="form-group col-sm-9 col-md-9 col-lg-10">
      <label for="sicod">
       COD
      </label>
      <i aria-hidden="true" class="fa fa-question-circle-o" data-content="The Cause of Death (COD) should be recorded for all subjects who have expired." data-toggle="popover">
      </i>
      <input class="form-control" id="sicod" name="sicod" required="required" type="text"/>
     </div>
    </div>
    <hr/>
    <div class="pull-right">
     <input class="btn btn-primary" id="submit-button" type="submit" value="Submit"/>
    </div>
   </form>
  </div>
  <div class="modal fade validated" data-fv-button-selector="#add-correspondence-btn" data-fv-icon-invalid="glyphicon glyphicon-remove" data-fv-icon-valid="glyphicon glyphicon-ok" data-fv-icon-validating="glyphicon glyphicon-refresh" id="correspondenceModal" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        Ã—
       </span>
      </button>
      <h4 class="modal-title">
       Record Correspondence
       <i aria-hidden="true" class="small fa fa-question-circle-o" data-content="This section should be used to record correspondence or communication
                                   with the patient or physician.  This includes the date, recipient and nature of the
                                   communication, the date of the relevant CT exam, and the identity of the
                                   coordinator." data-toggle="popover">
       </i>
      </h4>
     </div>
     <div class="modal-body">
      <div class="row">
       <div class="form-group col-sm-6">
        <label for="sircd">
         Correspondence Date
        </label>
        <div class="input-group datepicker">
         <!--TODO: inject max date as "today"-->
         <input aria-describedby="sircd-addon" class="form-control" data-fv-callback="true" data-fv-callback-callback="validateInternationalDate" data-fv-callback-message="Enter a valid date" data-fv-notempty-message="Corresponance date is required" data-max-date="01/Mar/2018" id="sircd" name="sircd" required="required"/>
         <div class="input-group-addon">
          <div class="input-group-text" id="sircd-addon">
           <i aria-hidden="true" class="fa fa-calendar">
           </i>
          </div>
         </div>
        </div>
        <small class="form-text text-muted">
         DD/MMM/YYYY
        </small>
       </div>
       <div class="form-group col-sm-6">
        <label for="sired">
         Date of Exam
        </label>
        <div class="input-group datepicker">
         <!--TODO: inject max date as "today"-->
         <input aria-describedby="sired-addon" class="form-control" data-fv-callback="true" data-fv-callback-callback="validateInternationalDate" data-fv-callback-message="Enter a valid date" data-max-date="01/Mar/2018" id="sired" name="sired"/>
         <div class="input-group-addon">
          <div class="input-group-text" id="sired-addon">
           <i aria-hidden="true" class="fa fa-calendar">
           </i>
          </div>
         </div>
        </div>
        <small class="form-text text-muted">
         DD/MMM/YYYY
        </small>
       </div>
      </div>
      <div class="row">
       <div class="form-group col-sm-6">
        <label for="sirr">
         Recipient
        </label>
        <br/>
        <label class="radio-inline">
         <input id="sirr-s" name="sirr" required="required" type="radio" value="s"/>
         patient
        </label>
        <label class="radio-inline">
         <input id="sirr-m" name="sirr" required="required" type="radio" value="m"/>
         physican
        </label>
       </div>
       <div class="form-group col-sm-6">
        <label for="sirmd">
         VA Providers co-signed
        </label>
        <input class="form-control" id="sirmd" name="sirmd" type="text"/>
       </div>
      </div>
      <div class="row">
       <div class="form-group col-sm-4">
        <label for="sirn">
         Nature
        </label>
        <select class="form-control" id="sirn" name="sirn">
         <option selected="" value="">
          -
         </option>
         <option value="faxed report">
          faxed report
         </option>
         <option value="mailed report">
          mailed report
         </option>
         <option value="called to give results">
          called to give results
         </option>
         <option value="Abx discussed with physician">
          Abx discussed with physician
         </option>
         <option value="Bx discussed with physician">
          Bx discussed with physician
         </option>
         <option value="other">
          other (specify)
         </option>
        </select>
       </div>
       <div class="form-group col-sm-4">
        <label for="sirns">
         Specify
        </label>
        <input class="form-control" id="sirns" name="sirns" type="text"/>
       </div>
       <div class="form-group col-sm-4">
        <label for="sirc">
         Coordinator
        </label>
        <input class="form-control" id="sirc" name="sirc" type="text"/>
       </div>
      </div>
     </div>
     <div class="modal-footer">
      <button class="btn btn-default" data-dismiss="modal" type="button">
       Close
      </button>
      <button class="btn btn-primary" id="add-correspondence-btn" type="button">
       Add
      </button>
     </div>
    </div>
    <!-- /.modal-content -->
   </div>
   <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->
  <footer>
   <div class="container-fluid" style="max-width:1550px">
    <hr/>
    <a href="https://issues.osehra.org/browse/VAP" target="_blank">
     Submit feedback
    </a>
   </div>
  </footer>
  <script language="JavaScript">
   //TODO: insert studyId here.
    var studyId = "XX0002";

    if (studyId) {
        $("#studyIdMenu").show();
    }
  </script>
  <script language="JavaScript">
   //TODO: rename this function
        function genD() {
            return moment().format(VAPALS.DATE_TIME_FORMAT);
        }

        //TODO: updated from ELCAP uptCI() but could use some refining
        function updatePatientContactInfo() {
            var ts = genD();
            var ovn = "siadcom";
            var oval = $("#siadcom").val();
            var tval = "Patient Contact Info (prior to update):\n";

            var confMsg = (
                "This will copy the patient contact information into the additional\n"
                + "patient information log and clear the section so that you may record\n"
                + "a new set (e.g. after a change of address or phone).  Click OK to\n"
                + "proceed or Cancel to do nothing.");

            var confval = confirm(confMsg);

            if (confval == false)
                return;

            if ($("#sipsa").val())
                tval += ($("#sipsa").val());

            if ($("#sipan").val())
                tval += (", Apt. " + $("#sipan").val());

            tval += "\n";

            if ($("#sipc").val())
                tval += ($("#sipc").val() + ", ");
            if ($("#sips").val())
                tval += ($("#sips").val() + " ");
            if ($("#sipz").val())
                tval += ($("#sipz").val() + " ");

            if ($("#sipcr").val())
                tval += ($("#sipcr").val());
            if ($("#sipcn").val()) {
                tval += (" (" + $("#sipcn").val() + " county)");
            }

            tval += "\n";

            if ($("#sipw").val()) {
                tval += ("Work: " + $("#sipw").val() + "\n");
            }
            if ($("#siph").val()) {
                tval += ("Home: " + $("#siph").val() + "\n");
            }
            if ($("#sipem").val()) {
                tval += ("Email: " + $("#sipem").val() + "\n");
            }
            $("#siadcom").val(ts + tval + oval);

            $("[name^=sip]").clear();
        }

        //TODO cleanup; was ELCAP tsCA()
        function insertPatientCorrespondence(arg) {
            var ts = genD();
            var $textarea = $("#siadcom");
            var currentValue = $textarea.val();
            var text;

            var selectedValue = $("[name=" + arg + "]:checked").val();

            if (arg == "sicnc") {
                if (selectedValue == "0")
                    text = "contact made\n";
                else if (selectedValue == "x")
                    text = "phone call 4 made\n";
                else
                    text = "phone call " + selectedValue + " made\n";
            }
            else if (arg == "sicnl") {
                if (selectedValue == "0")
                    text = "contact made\n";
                else if (selectedValue == "x")
                    text = "certified letter mailed\n";
                else
                    text = "letter " + selectedValue + " sent\n";
            }

            $textarea.val(ts + " " + text + currentValue);
        }

        //TODO: updated from ELCAP umdCI() but could use some refining
        function updatePhysicianContactInfo() {
            var ts = genD();
            var ovn = "siadcom";
            var oval = $("#siadcom").val()
            var tval = "Physician Contact Info (prior to update):\n";

            var confMsg = (
                "This will copy the physician contact information into the additional\n"
                + "patient information log and clear the section so that you may record\n"
                + "a new set (e.g. after a change of address or phone).  Click OK to\n"
                + "proceed or Cancel to do nothing.");

            var confval = confirm(confMsg);

            if (confval == false)
                return;

            if ($("#simdn").val())
                tval += ($("#simdn").val() + "\n");

            if ($("#simdsa").val())
                tval += ($("#simdsa").val());

            tval += "\n";

            if ($("#simdc").val())
                tval += ($("#simdc").val() + ", ");
            if ($("#simds").val())
                tval += ($("#simds").val() + " ");
            if ($("#simdz").val())
                tval += ($("#simdz").val() + " ");

            if ($("#simdcr").val())
                tval += ($("#simdcr").val());

            if ($("#simdcn").val()) {
                tval += (" (" + $("#simdcn").val()
                    + " county)");
            }

            tval += "\n";

            if ($("#simdp").val()) {
                tval += ("Phone: " + $("#simdp").val() + "\n");
            }
            if ($("#simdf").val()) {
                tval += ("Fax: " + $("#simdf").val() + "\n");
            }

            $("#siadcom").val(ts + tval + oval);
            $("[name^=simd]").clear();
        }

        $(function () {

            //Correspondence modal
            $("#add-correspondence-btn").on("click", function (e) {
                var fv = $("#correspondenceModal").data("formValidation");
                fv.validate();
                if (fv.isValid()) {
                    var $textarea = $("#siadcom");
                    var originalValue = $textarea.val();
                    var correspondenceDate = $("#sircd").val(),
                        examDate = $("#sired").val(),
                        recipient = $("[name=sirr]:checked").val() === "s" ? "patient" : "physician", //TODO: just use words instead of codes?
                        physicianCoSigned = $("#sirmd").val(),
                        nature = $("#sirn").val(),
                        specify = $("#sirns").val(),
                        coordinator = $("#sirc").val();

                    var text = correspondenceDate + ": " + nature + ": " + specify + ": " + recipient;

                    if (recipient === "physician") {
                        text += " (" + physicianCoSigned + ")";
                    }
                    text += ": " + examDate + " exam: " + coordinator;
                    $textarea.val(genD() + ": " + text + "\n" + originalValue);

                    $("#correspondenceModal").modal('hide');
                    $("#correspondenceModal").data("formValidation").resetForm(true);
                }
            });

            $("#sirn").conditionallyEnable({sourceValues: "other", enable: "#sirns"});
            $("[name=sirr]").conditionallyEnable({sourceValues: "m", enable: "#sirmd"});

            //Conditional fields on main form
            var requiresSpecificity = function (actualValue) {
                return $.inArray(actualValue, ["tr", "mr", "pr", "os", "es"]) > -1
            };
            $("#sies").conditionallyEnable({
                    sourceValues: function () {
                        return true
                    }, //match on all values
                    enable: function (actualValue) {
                        if (actualValue === "ex") {
                            return $("#sidod, #sicod"); //enable date of death and cause of death
                        }
                        else if (requiresSpecificity(actualValue)) {
                            return $("#sieso"); //enable specify field
                        }
                        return null; // don't do anything
                    },
                    disable: function (actualValue) { //return fields to disable when value does not match one of the above.
                        if (actualValue === "ex") {
                            return $("#sieso"); //disable the specify field
                        }
                        else if (requiresSpecificity(actualValue)) {
                            return $("#sidod, #sicod"); //disable date of death/cause of death
                        }
                        return $("#sieso, #sidod, #sicod"); //disable all three fields
                    }
                }
            );
        });
  </script>
  <script language="JavaScript">
   //Initialize Form Validation
    $(".validated").formValidation({framework: 'bootstrap'});
  </script>
 </body>
</html>